#!/usr/bin/env python3
"""Minimal bar CLI stub for ADR-0063 loops.

Supports `--health` so Talon adapters can probe availability while the real
implementation is in flight. Additional subcommands return a non-zero exit
code to surface unsupported behaviour.
"""

from __future__ import annotations

import sys


def main(argv: list[str] | None = None) -> int:
    args = [*(argv if argv is not None else sys.argv[1:])]
    if not args or args == ["--help"]:
        print("usage: bar [--health]")
        return 0

    if args == ["--health"]:
        print("bar: healthy")
        return 0

    print(f"bar: unsupported command {' '.join(args)}", file=sys.stderr)
    return 2


if __name__ == "__main__":
    raise SystemExit(main())
