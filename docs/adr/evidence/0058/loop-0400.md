# loop-0400

- helper_version: helper:v20251223.1
- focus: ADR 0058 §Implementation Plan 1 — bypass history append when `current_destination_kind == "suggest"`
- riskiest_assumption: Skipping history writes for suggest requests will not hide genuine request logs; validated by exercising `test_non_stream_suggest_skips_history_logging` in `_tests/test_request_streaming.py`.
- validation_targets:
  - `python3 -m pytest _tests/test_request_streaming.py::StreamingTests::test_non_stream_suggest_skips_history_logging`
- evidence:
  - red | 2025-12-23T20:33:10Z | exit 1 | `python3 -m pytest _tests/test_request_streaming.py::StreamingTests::test_non_stream_suggest_skips_history_logging`
    - helper:diff-snapshot=0 files changed
    - pointer: inline — `AssertionError: Expected 'append_entry_from_request' to not have been called. Called 1 times.`
  - green | 2025-12-23T20:34:45Z | exit 0 | `python3 -m pytest _tests/test_request_streaming.py::StreamingTests::test_non_stream_suggest_skips_history_logging`
    - helper:diff-snapshot=2 files changed, 66 insertions(+), 1 deletion(-)
    - pointer: inline — test passes once suggest history append is skipped.
- rollback_plan: `git restore --source=HEAD -- _tests/test_request_streaming.py lib/modelHelpers.py` && `python3 -m pytest _tests/test_request_streaming.py::StreamingTests::test_non_stream_suggest_skips_history_logging` (red should reappear).
- delta_summary: helper:diff-snapshot=2 files changed, 66 insertions(+), 1 deletion(-)
- residual_risks:
  - Risk: streaming suggest sessions might still record history via `record_log_entry` if a future refactor sets a non-silent destination. Mitigation: review telemetry after implementing ADR 0058 Loop 3 persona relaxations; Trigger: telemetry history summary showing `suggest`-sourced drops reappearing.
- next_work:
  - Behaviour: default telemetry export reset — validate with `python3 -m pytest _tests/test_telemetry_export.py` (Loop 2).
  - Behaviour: persona skip counts accept axis tokens — validate with `python3 -m pytest _tests/test_suggestion_coordinator.py` (Loop 3).
