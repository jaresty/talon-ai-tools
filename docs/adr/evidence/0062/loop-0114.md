- helper_version: helper:v20251223.1
- focus: ADR-0062 §Refactor Plan – Guidance Surface Coordinator (GUI close allowlists)
- riskiest_assumption: Overlay closers continue to block during in-flight activity despite passive intent, causing Concordance drift for quick toggles (probability medium, impact medium on overlay UX).
- validation_targets:
  - python3 -m pytest _tests/test_model_pattern_gui_guard.py _tests/test_prompt_pattern_gui_guard.py _tests/test_model_suggestion_gui_guard.py
- evidence:
  - red | 2025-12-27T15:12:00Z | exit 1 | python3 -m pytest _tests/test_model_pattern_gui_guard.py _tests/test_prompt_pattern_gui_guard.py _tests/test_model_suggestion_gui_guard.py
    - helper:diff-snapshot=0 files changed
    - pointer: inline — new tests fail because guard_surface_request never receives allow_inflight flag for close actions.
  - green | 2025-12-27T15:14:20Z | exit 0 | python3 -m pytest _tests/test_model_pattern_gui_guard.py _tests/test_prompt_pattern_gui_guard.py _tests/test_model_suggestion_gui_guard.py
    - helper:diff-snapshot=6 files changed, 74 insertions(+), 9 deletions(-)
    - pointer: inline — guard suites pass with allow_inflight delegation for pattern, prompt pattern, and suggestion GUI closers.
  - removal | 2025-12-27T15:14:50Z | exit 1 | git stash push --keep-index --message loop-0114-removal && python3 -m pytest _tests/test_model_pattern_gui_guard.py _tests/test_prompt_pattern_gui_guard.py _tests/test_model_suggestion_gui_guard.py
    - helper:diff-snapshot=6 files changed, 74 insertions(+), 9 deletions(-)
    - pointer: inline — reverting code restores failures, confirming closers rely on allow flag.
- rollback_plan: git stash push --keep-index --message loop-0114-removal && python3 -m pytest _tests/test_model_pattern_gui_guard.py _tests/test_prompt_pattern_gui_guard.py _tests/test_model_suggestion_gui_guard.py && git stash pop && git reset _tests/test_model_pattern_gui_guard.py _tests/test_prompt_pattern_gui_guard.py _tests/test_model_suggestion_gui_guard.py
- delta_summary: helper:diff-snapshot=6 files changed, 74 insertions(+), 9 deletions(-); pattern/prompt/suggestion GUI closers now pass allow_inflight to surface guard with targeted tests.
- residual_risks:
  - Remaining overlay actions (e.g., confirmation GUI) should be reviewed for passive guard parity.
- next_work:
  - Behaviour: audit confirmation GUI close pathways — python3 -m pytest _tests/test_model_help_canvas_guard.py _tests/test_model_response_canvas_guard.py (shared patterns) — future-shaping: ensure confirmation overlays honour allow_inflight semantics.
