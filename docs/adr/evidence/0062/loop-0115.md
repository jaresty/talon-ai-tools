- helper_version: helper:v20251223.1
- focus: ADR-0062 §Refactor Plan – Guidance Surface Coordinator (confirmation GUI gating)
- riskiest_assumption: Confirmation GUI would retain bespoke gating and block passive closes, diverging from surfaceGuidance contract (probability high, impact medium on confirmation workflows).
- validation_targets:
  - python3 -m pytest _tests/test_model_confirmation_gui_guard.py _tests/test_model_pattern_gui_guard.py _tests/test_prompt_pattern_gui_guard.py _tests/test_model_suggestion_gui_guard.py
- evidence:
  - red | 2025-12-27T15:20:10Z | exit 1 | python3 -m pytest _tests/test_model_confirmation_gui_guard.py _tests/test_model_pattern_gui_guard.py _tests/test_prompt_pattern_gui_guard.py _tests/test_model_suggestion_gui_guard.py
    - helper:diff-snapshot=4 files changed, 21 insertions(+), 21 deletions(-)
    - pointer: inline — confirmation guard tests fail because confirmation module lacks guard_surface_request delegation and closers omit allow_inflight.
  - green | 2025-12-27T15:22:40Z | exit 0 | python3 -m pytest _tests/test_model_confirmation_gui_guard.py _tests/test_model_pattern_gui_guard.py _tests/test_prompt_pattern_gui_guard.py _tests/test_model_suggestion_gui_guard.py
    - helper:diff-snapshot=5 files changed, 72 insertions(+), 171 deletions(-)
    - pointer: inline — guard suites pass with confirmation GUI delegating to surfaceGuidance and closers forwarding allow_inflight.
  - removal | 2025-12-27T15:23:20Z | exit 1 | git stash push --keep-index --message loop-0115-removal && python3 -m pytest _tests/test_model_confirmation_gui_guard.py _tests/test_model_pattern_gui_guard.py _tests/test_prompt_pattern_gui_guard.py _tests/test_model_suggestion_gui_guard.py
    - helper:diff-snapshot=5 files changed, 72 insertions(+), 171 deletions(-)
    - pointer: inline — reverting confirmation code while retaining tests reproduces missing allow_inflight flag.
- rollback_plan: git stash push --keep-index --message loop-0115-removal && python3 -m pytest _tests/test_model_confirmation_gui_guard.py _tests/test_model_pattern_gui_guard.py _tests/test_prompt_pattern_gui_guard.py _tests/test_model_suggestion_gui_guard.py && git stash pop && git reset _tests/test_model_confirmation_gui_guard.py _tests/test_model_pattern_gui_guard.py _tests/test_prompt_pattern_gui_guard.py _tests/test_model_suggestion_gui_guard.py
- delta_summary: helper:diff-snapshot=5 files changed, 72 insertions(+), 171 deletions(-); confirmation GUI now delegates to surfaceGuidance with allow_inflight closers, and associated GUI tests cover the shared logic.
- residual_risks:
  - Confirmation GUI actions that trigger other overlays should be monitored when additional surfaces adopt shared guard semantics.
- next_work:
  - Behaviour: audit any remaining overlay entry points (e.g., confirmation advanced actions) — python3 -m pytest _tests/test_model_confirmation_gui_guard.py — future-shaping: ensure ancillary confirmation helpers adhere to canonical guard contract.
