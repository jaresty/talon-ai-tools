# loop-0016 package bar binary with checksum manifest

## metadata
- helper_version: helper:v20251223.1
- focus: Implementation Guardrails → Delivery posture — Salient task “Replace stubbed CLI delegation with real binary” (validation: `python3 scripts/tools/check_cli_assets.py`).
- riskiest_assumption: Without a packaged CLI tarball and checksum manifest under `artifacts/cli/`, Talon cannot verify the release artefact before delegation; `python3 scripts/tools/check_cli_assets.py` would stay red and block rollout.
- validation_targets:
  - `python3 scripts/tools/check_cli_assets.py` — exercises the release artefact guardrail for packaged CLI assets.
- rollback_plan: `git restore --source=HEAD scripts/tools/check_cli_assets.py scripts/tools/package_bar_cli.py && rm artifacts/cli/bar-*.tar.gz*` followed by `python3 scripts/tools/check_cli_assets.py` to confirm the guardrail returns red.
- delta_summary: helper:diff-snapshot=2 files changed, 186 insertions(+), 9 deletions(-) — added CLI packaging helper and checksum verification.
- loops_remaining_forecast:
  - 2 loops — Wire Talon startup to verify/install tarball before delegation (`python3 -m pytest _tests/test_cli_talon_parity.py`), confidence medium.
  - 2 loops — Add signature/CI publication for CLI artefacts (`scripts/tools/check_cli_assets.py` + release automation), confidence medium.
- residual_risks:
  - Signed artefacts absent (severity medium). Mitigation: integrate signature generation & CI upload next slice; monitor `scripts/tools/check_cli_assets.py` for checksum mismatch events.
- next_work:
  - Behaviour: Replace stubbed CLI delegation with real binary — run `python3 -m pytest _tests/test_cli_talon_parity.py` after wiring Talon startup against packaged artefact.
  - Behaviour: Release checksum manifest hardening — extend `scripts/tools/check_cli_assets.py` with signature enforcement and CI contract.

## loop-0016 red | helper:rerun python3 scripts/tools/check_cli_assets.py
- 2026-01-02T20:18:39Z | exit 1
- helper:diff-snapshot=2 files changed, 186 insertions(+), 9 deletions(-)
- failure: release artefact tarball and checksum manifest missing | inline

```
missing: artifacts/cli/bar-darwin-arm64.tar.gz
missing: artifacts/cli/bar-darwin-arm64.tar.gz.sha256
```

## loop-0016 green | helper:rerun python3 scripts/tools/check_cli_assets.py
- 2026-01-02T20:20:47Z | exit 0
- helper:diff-snapshot=2 files changed, 186 insertions(+), 9 deletions(-)
- packaged CLI tarball + manifest present; checksum verified | inline

```
all CLI assets present
```

## loop-0016 removal | helper:rerun rm artifacts/cli/bar-darwin-arm64.tar.gz.sha256 && python3 scripts/tools/check_cli_assets.py
- 2026-01-02T20:19:37Z | exit 1
- helper:diff-snapshot=0 files changed
- failure returns when checksum manifest removed, guarding release pipeline | inline

```
missing: artifacts/cli/bar-darwin-arm64.tar.gz.sha256
```
