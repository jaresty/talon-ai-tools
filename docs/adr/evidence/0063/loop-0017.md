# loop-0017 install packaged bar binary before delegation

## metadata
- helper_version: helper:v20251223.1
- focus: Implementation Guardrails → Delivery posture — Salient task "Replace stubbed CLI delegation with real binary" (validation: `python3 scripts/tools/install_bar_cli.py --quiet`).
- riskiest_assumption: Without an installer that verifies and extracts the packaged CLI tarball, Talon startup will continue to require a local Go toolchain via `go build`, keeping the parity harness red in environments without Go.
- validation_targets:
  - `python3 scripts/tools/install_bar_cli.py --quiet`
- rollback_plan: `git restore --source=HEAD bin/bar && rm scripts/tools/install_bar_cli.py && python3 scripts/tools/install_bar_cli.py --quiet`
- delta_summary: helper:diff-snapshot=5 files changed, 253 insertions(+), 10 deletions(-) — added CLI installer and updated bin wrapper
- loops_remaining_forecast:
  - 2 loops — Wire Talon bootstrap to run the installer before delegation (`python3 -m pytest _tests/test_cli_talon_parity.py`), confidence medium.
  - 2 loops — Publish tarball + manifest to CI artifacts with signature enforcement (`scripts/tools/check_cli_assets.py`), confidence medium.
- residual_risks:
  - Installer not yet invoked by Talon startup (severity medium). Mitigation: integrate installer call into Talon bootstrap; monitor parity harness for missing `bin/bar.bin` at startup.
- next_work:
  - Behaviour: Replace stubbed CLI delegation with real binary — verify Talon bootstrap installs packaged CLI before delegation via `python3 -m pytest _tests/test_cli_talon_parity.py`.
  - Behaviour: Release checksum manifest hardening — add signature/CI upload checks to `scripts/tools/check_cli_assets.py`.

## loop-0017 red | helper:rerun python3 scripts/tools/install_bar_cli.py
- 2026-01-02T21:11:38Z | exit 2
- helper:diff-snapshot=0 files changed
- failure: installer absent so packaged CLI cannot be installed | inline

```
python3: can't open file '/Users/tkma6d4/.talon/user/talon-ai-tools/scripts/tools/install_bar_cli.py': [Errno 2] No such file or directory
```

## loop-0017 green | helper:rerun python3 scripts/tools/install_bar_cli.py --quiet
- 2026-01-02T21:13:36Z | exit 0
- helper:diff-snapshot=5 files changed, 253 insertions(+), 10 deletions(-)
- packaged CLI tarball verified and installed to `bin/bar.bin` | inline

```
(no output)
```

## loop-0017 removal | helper:rerun python3 scripts/tools/install_bar_cli.py --quiet
- 2026-01-02T21:14:49Z | exit 2
- helper:diff-snapshot=0 files changed
- failure returns after installer removed, guarding packaged artefact behaviour | inline

```
python3: can't open file '/Users/tkma6d4/.talon/user/talon-ai-tools/scripts/tools/install_bar_cli.py': [Errno 2] No such file or directory
```
