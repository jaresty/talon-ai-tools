# loop-0020 make bootstrap warnings actionable for installers

## metadata
- helper_version: helper:v20251223.1
- focus: Implementation Guardrails → Delivery posture — Salient task "Replace stubbed CLI delegation with real binary" (validation: `python3 - <<'PY'\nimport pathlib, sys, io\nfrom contextlib import redirect_stderr\nmanifest = pathlib.Path('artifacts/cli/bar-darwin-arm64.tar.gz.sha256')\nbackup = manifest.read_bytes()\nmanifest.unlink()\nimport bootstrap\nbuf = io.StringIO()\nwith redirect_stderr(buf):\n    bootstrap.bootstrap()\nmanifest.write_bytes(backup)\noutput = buf.getvalue()\nprint(output, end='')\nPY`).
- riskiest_assumption: Without directing operators to rebuild the packaged CLI, bootstrap warnings leave them guessing how to restore parity when artefacts are missing.
- validation_targets:
  - `python3 - <<'PY' ... PY`
- rollback_plan: `git restore --source=HEAD bootstrap.py && python3 scripts/tools/install_bar_cli.py --quiet`
- delta_summary: helper:diff-snapshot=3 files changed, 94 insertions(+), 3 deletions(-) — add actionable bootstrap warning and document evidence
- loops_remaining_forecast:
  - 1 loop — Surface bootstrap warning telemetry via Talon adapters and parity harness (`python3 -m pytest _tests/test_cli_talon_parity.py`), confidence medium.
  - 2 loops — Publish signed CLI artefacts with CI enforcement (`scripts/tools/check_cli_assets.py`), confidence medium.
- residual_risks:
  - Warning still only appears on stderr (severity medium). Mitigation: next slice wires adapter telemetry to fail parity when packaged assets drift.
- next_work:
  - Behaviour: Replace stubbed CLI delegation with real binary — ensure Talon adapters capture bootstrap warnings via `python3 -m pytest _tests/test_cli_talon_parity.py`.
  - Behaviour: Release checksum manifest hardening — add signature validation to `scripts/tools/check_cli_assets.py`.

## loop-0020 red | helper:rerun python3 - <<'PY'
import pathlib, sys, io
from contextlib import redirect_stderr
manifest = pathlib.Path('artifacts/cli/bar-darwin-arm64.tar.gz.sha256')
backup = manifest.read_bytes()
manifest.unlink()
import bootstrap
buf = io.StringIO()
with redirect_stderr(buf):
    bootstrap.bootstrap()
manifest.write_bytes(backup)
output = buf.getvalue()
print(output, end='')
PY
- 2026-01-02T21:22:43Z | exit 0
- helper:diff-snapshot=0 files changed
- failure: warning lacked remediation instructions | inline

```
bootstrap: install failed; falling back to go build (missing CLI manifest: /Users/tkma6d4/.talon/user/talon-ai-tools/artifacts/cli/bar-darwin-arm64.tar.gz.sha256)
```

## loop-0020 green | helper:rerun python3 - <<'PY'
import pathlib, sys, io
from contextlib import redirect_stderr
manifest = pathlib.Path('artifacts/cli/bar-darwin-arm64.tar.gz.sha256')
backup = manifest.read_bytes()
manifest.unlink()
import bootstrap
buf = io.StringIO()
with redirect_stderr(buf):
    bootstrap.bootstrap()
manifest.write_bytes(backup)
output = buf.getvalue()
print(output, end='')
PY
- 2026-01-02T21:38:12Z | exit 0
- helper:diff-snapshot=3 files changed, 94 insertions(+), 3 deletions(-)
- success: warning now directs operators to rebuild packaged CLI before falling back | inline

```
bootstrap: install failed; run `python3 scripts/tools/package_bar_cli.py --print-paths` to rebuild packaged CLI (falling back to go build: missing CLI manifest: /Users/tkma6d4/.talon/user/talon-ai-tools/artifacts/cli/bar-darwin-arm64.tar.gz.sha256)
```

## loop-0020 removal | helper:rerun python3 - <<'PY'
import pathlib, sys, io
from contextlib import redirect_stderr
manifest = pathlib.Path('artifacts/cli/bar-darwin-arm64.tar.gz.sha256')
backup = manifest.read_bytes()
manifest.unlink()
import bootstrap
buf = io.StringIO()
with redirect_stderr(buf):
    bootstrap.bootstrap()
manifest.write_bytes(backup)
output = buf.getvalue()
print(output, end='')
PY
- 2026-01-02T21:32:57Z | exit 0
- helper:diff-snapshot=0 files changed
- failure returns once actionable warning removed | inline

```
bootstrap: install failed; falling back to go build (missing CLI manifest: /Users/tkma6d4/.talon/user/talon-ai-tools/artifacts/cli/bar-darwin-arm64.tar.gz.sha256)
```
