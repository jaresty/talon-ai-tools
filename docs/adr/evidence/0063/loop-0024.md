# loop-0024 route bootstrap warnings through telemetry actions

## metadata
- helper_version: helper:v20251223.1
- focus: Implementation Guardrails → Delivery posture — Salient task "Replace stubbed CLI delegation with real binary" (validation: `python3 -m pytest _tests/test_cli_talon_parity.py`).
- riskiest_assumption: If bootstrap warnings are not recorded as structured telemetry and exposed through Talon actions, adapters will miss missing-artefact rebuild instructions and silently fall back to `go build`, keeping delivery posture brittle.
- validation_targets:
  - `python3 -m pytest _tests/test_cli_talon_parity.py`
- rollback_plan: `git restore --source=HEAD bootstrap.py _tests/test_cli_talon_parity.py lib/bootstrapTelemetry.py`
- delta_summary: helper:diff-snapshot=4 files changed, 69 insertions(+), 2 deletions(-) — add telemetry bridge, expose actions, and assert parity harness reads structured warnings.
- loops_remaining_forecast:
  - 1 loop — Bind Talon delegation fallback to telemetry channel so CLI absence flips adapters automatically (`python3 -m pytest _tests/test_cli_talon_parity.py`), confidence medium.
  - 2 loops — Harden checksum enforcement with CI upload integration (`scripts/tools/check_cli_assets.py`), confidence medium.
- residual_risks:
  - Telemetry is in-memory only; Talon restart clears warning history (severity medium). Mitigation: next loop forwards telemetry into adapter health state before delegation. Monitoring: parity harness should continue asserting adapter consumption.
- next_work:
  - Behaviour: Replace stubbed CLI delegation with real binary — wire adapter fallback thresholds to telemetry warnings (`python3 -m pytest _tests/test_cli_talon_parity.py`).
  - Behaviour: Release checksum manifest hardening — extend guardrail to verify signature artefacts in CI (`scripts/tools/check_cli_assets.py`).

## loop-0024 red | helper:rerun python3 -m pytest _tests/test_cli_talon_parity.py
- 2026-01-02T23:43:26Z | exit 1
- helper:diff-snapshot=0 files changed
- failure: telemetry capture omitted rebuild instruction so parity assertion failed | inline

```
>       self.assertTrue(
            any(
                "`python3 scripts/tools/package_bar_cli.py --print-paths`"
                in message
                for message in telemetry_messages
            ),
            "Bootstrap telemetry should capture rebuild instructions for adapters",
        )
E       AssertionError: False is not true : Bootstrap telemetry should capture rebuild instructions for adapters
```

## loop-0024 green | helper:rerun python3 -m pytest _tests/test_cli_talon_parity.py
- 2026-01-02T23:43:45Z | exit 0
- helper:diff-snapshot=4 files changed, 69 insertions(+), 2 deletions(-)
- success: parity harness now asserts telemetry + Talon actions capture rebuild instructions | inline

```
============================= test session starts ==============================
platform darwin -- Python 3.11.14, pytest-8.2.1, pluggy-1.6.0
rootdir: /Users/tkma6d4/.talon/user/talon-ai-tools
configfile: pyproject.toml
collected 4 items

_tests/test_cli_talon_parity.py ....                                     [100%]
```

## loop-0024 removal | helper:rerun python3 -m pytest _tests/test_cli_talon_parity.py
- 2026-01-02T23:44:00Z | exit 1
- helper:diff-snapshot=0 files changed
- failure returns once telemetry module removed from Talon actions | inline

```
E   ModuleNotFoundError: No module named 'lib.bootstrapTelemetry'
```
