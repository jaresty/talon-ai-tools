# loop-0036 enforce tarball manifest signatures before parity

## metadata
- helper_version: helper:v20251223.1
- focus: Implementation Guardrails → Delivery posture — enforce release artefact signature validation before parity (`python3 scripts/tools/check_cli_assets.py`).
- riskiest_assumption: Without verifying tarball signature files, releases could ship tampered CLI binaries while guardrails remain green, leaving Talon to delegate against untrusted artefacts.
- validation_targets:
  - `python3 scripts/tools/check_cli_assets.py`
- rollback_plan: `git restore --source=HEAD scripts/tools/package_bar_cli.py scripts/tools/install_bar_cli.py scripts/tools/check_cli_assets.py _tests/test_check_cli_assets.py _tests/test_cli_talon_parity.py bootstrap.py docs/adr/0063-go-cli-single-source-of-truth.work-log.md && rm docs/adr/evidence/0063/loop-0036.md`
- delta_summary: helper:diff-snapshot=4 files changed, 101 insertions(+), 29 deletions(-) — sign tarball manifests, verify signatures in installer/guard, extend tests, and update work log.
- loops_remaining_forecast:
  - 1 loop — Integrate CI signing and publication of artefact signatures (`python3 scripts/tools/check_cli_assets.py`), confidence medium.
  - 2 loops — Telemetry for signature freshness and key rotation alerts (`python3 scripts/tools/check_cli_assets.py`), confidence medium.
- residual_risks:
  - Signing key remains static in-repo (severity medium). Mitigation: next slice sources signing material from CI secrets and records telemetry when signatures rotate.
- next_work:
  - Behaviour: Harden release pipeline with checksum manifest — wire CI job to publish signed manifests and update guardrails to require CI metadata (`python3 scripts/tools/check_cli_assets.py`).
  - Behaviour: Replace stubbed CLI delegation with real binary — ensure bootstrap records signature telemetry before enabling delegation (`python3 -m pytest _tests/test_cli_talon_parity.py`).

## loop-0036 red | helper:rerun python3 scripts/tools/check_cli_assets.py
- 2026-01-03T07:11:18Z | exit 1
- helper:diff-snapshot=0 files changed
- failure: tarball manifest signature missing triggers guardrail failure before parity runs | inline

```
missing tarball manifest signature: artifacts/cli/bar-darwin-arm64.tar.gz.sha256.sig
```

## loop-0036 green | helper:rerun python3 scripts/tools/check_cli_assets.py
- 2026-01-03T07:11:50Z | exit 0
- helper:diff-snapshot=4 files changed, 101 insertions(+), 29 deletions(-)
- success: guardrail passes with signed manifests and snapshot signatures restored | inline

```
all CLI assets present
```

## loop-0036 removal | helper:rerun python3 scripts/tools/check_cli_assets.py
- 2026-01-03T07:12:36Z | exit 1
- helper:diff-snapshot=0 files changed
- failure returns after removing the tarball manifest signature, confirming guardrails block unsigned artefacts | inline

```
missing tarball manifest signature: artifacts/cli/bar-darwin-arm64.tar.gz.sha256.sig
```
