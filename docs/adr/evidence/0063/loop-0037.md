# loop-0037 source release signing key from CI environment

## metadata
- helper_version: helper:v20251223.1
- focus: Implementation Guardrails → Delivery posture — source release signing key from environment for packaging/install guards (`python3 -m pytest _tests/test_check_cli_assets.py`).
- riskiest_assumption: Without using CI-provided signing keys, local defaults could leak into automated pipelines, letting unsigned artefacts pass guardrails when CI rotates keys.
- validation_targets:
  - `python3 -m pytest _tests/test_check_cli_assets.py`
- rollback_plan: `git restore --source=HEAD scripts/tools/package_bar_cli.py scripts/tools/install_bar_cli.py scripts/tools/check_cli_assets.py _tests/test_check_cli_assets.py _tests/test_cli_talon_parity.py docs/adr/0063-go-cli-single-source-of-truth.work-log.md && rm docs/adr/evidence/0063/loop-0037.md`
- delta_summary: helper:diff-snapshot=5 files changed, 134 insertions(+), 31 deletions(-) — move signing key to env, tighten signature verification, extend bootstrap warnings, and update guard tests plus parity harness.
- loops_remaining_forecast:
  - 1 loop — Wire CI release job to publish signed artefacts and telemetry (`python3 scripts/tools/check_cli_assets.py`), confidence medium.
  - 2 loops — Emit signature freshness telemetry and alert on key rotation drift (`python3 scripts/tools/check_cli_assets.py`), confidence medium.
- residual_risks:
  - CI key rotation telemetry is not yet recorded (severity medium). Mitigation: next slice emits signing key identifiers and monitors for mismatches across artefacts.
- next_work:
  - Behaviour: Harden release pipeline with checksum manifest — integrate CI signing workflow and publish signed artefacts (`python3 scripts/tools/check_cli_assets.py`).
  - Behaviour: Replace stubbed CLI delegation with real binary — record bootstrap telemetry when CI key differs from local default (`python3 -m pytest _tests/test_cli_talon_parity.py`).

## loop-0037 red | helper:rerun python3 scripts/tools/check_cli_assets.py
- 2026-01-03T07:42:46Z | exit 1
- helper:diff-snapshot=0 files changed
- failure: guardrail blocks release tarball when signature file is missing | inline

```
missing tarball manifest signature: artifacts/cli/bar-darwin-arm64.tar.gz.sha256.sig
```

## loop-0037 green | helper:rerun python3 scripts/tools/check_cli_assets.py
- 2026-01-03T07:43:59Z | exit 0
- helper:diff-snapshot=5 files changed, 134 insertions(+), 31 deletions(-)
- success: guardrail passes with CI-provided signing key and manifest signature restored | inline

```
all CLI assets present
```

## loop-0037 removal | helper:rerun python3 scripts/tools/check_cli_assets.py
- 2026-01-03T07:44:57Z | exit 1
- helper:diff-snapshot=0 files changed
- failure returns after removing tarball signature again, confirming guard remains strict | inline

```
missing tarball manifest signature: artifacts/cli/bar-darwin-arm64.tar.gz.sha256.sig
```
